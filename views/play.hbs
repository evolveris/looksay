<main class="nine columns">
  <div class="info-panel">
    <span>Starting sequence:</span>
    <h3 class="random-init-sequence">{{randomInitSequence}}</h3>
  </div>
  <form autocomplete="off">
    <input type="text">
    <button class="xxx">Send to node</button>
    <br>
    <textarea col="50" rows="20"></textarea>
  </form>
</main>
<aside class="three columns">
  <div class="info-panel">
    <span>Score:</span>
    <h5>Player 1: 1</h5>
    <h5>Player 2: 0</h5>
  </div>
</aside>

<link href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet"> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js" integrity="sha512-WNLxfP/8cVYL9sj8Jnp6et0BkubLP31jhTG9vhL/F5uEZmg5wEzKoXp1kJslzPQWwPT1eyMiSxlKCgzHLOTOTQ==" crossorigin="anonymous"></script>
<script>
$(function () {
  // if user is running mozilla then use it's built-in WebSocket
  window.WebSocket = window.WebSocket || window.MozWebSocket;

  var connection = new WebSocket('ws://192.168.0.3:3000');

  connection.onopen = function () {
    console.info("connection opened!");
    // connection is opened and ready to use
    // initialise username here
  };

  connection.onerror = function (error) {
    console.error(error);
    // an error occurred when sending/receiving data
  };

  connection.onmessage = function (message) {
    // try to decode json (I assume that each message
    // from server is json)
    try {
        var randomInitSequence = $(".random-init-sequence").text();
        var textarea = $("textarea");
        if (message.data == randomInitSequence) {
          textarea.val(textarea.val() + "\n" + "Raspuns corect!" + "\n");
        } else {
          textarea.val(textarea.val() + "\n" + message.data + "\n");
        }
    } catch (e) {
      console.log('This doesn\'t look like a valid JSON: ',
          message.data);
      return;
    }
  };

  $("button").click((e) => {
      e.preventDefault();
      connection.send($("input").val());
      $("input").val("");
  });


});
</script>
